# DIAGRAMA DA ARQUITETURA - ETAPA 1

## Fluxo Completo de uma RequisiÃ§Ã£o HTTP

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NAVEGADOR DO USUÃRIO                         â”‚
â”‚                   http://localhost/...                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SERVIDOR WEB (Apache)                        â”‚
â”‚  com mÃ³dulo mod_rewrite habilitado                              â”‚
â”‚  .htaccess redireciona todas requisiÃ§Ãµes para index.php         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              public/index.php (ROUTER PRINCIPAL)                â”‚
â”‚  1. Carrega config.php                                          â”‚
â”‚  2. Autoload de classes                                         â”‚
â”‚  3. Inicia sessÃ£o                                               â”‚
â”‚  4. Define headers de seguranÃ§a                                 â”‚
â”‚  5. Roteia para controller apropriado                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                        â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
                        â”‚            â”‚
                        â–¼            â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ app/config/      â”‚  â”‚ app/database/    â”‚
        â”‚ â€¢ config.php     â”‚  â”‚ â€¢ Database.php   â”‚
        â”‚ â€¢ Session.php    â”‚  â”‚   (PDO)          â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                     â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    ESCOLHE CONTROLLER           â”‚
        â”‚  URL: /clientes/listar          â”‚
        â”‚  â†’ ClienteController->listar()  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   app/controllers/              â”‚
        â”‚   ClienteController extends     â”‚
        â”‚   BaseController                â”‚
        â”‚                                 â”‚
        â”‚   1. Valida autenticaÃ§Ã£o        â”‚
        â”‚   2. Valida CSRF token          â”‚
        â”‚   3. Busca dados do modelo      â”‚
        â”‚   4. Passa dados para view      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚      app/models/                â”‚
        â”‚   ClienteModel extends          â”‚
        â”‚   BaseModel                     â”‚
        â”‚                                 â”‚
        â”‚   Exemplo: $model->all()        â”‚
        â”‚   - ConstrÃ³i SQL                â”‚
        â”‚   - Executa via Database        â”‚
        â”‚   - Retorna array               â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    MySQL Database               â”‚
        â”‚  SELECT * FROM clientes         â”‚
        â”‚  (Prepared statement)           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Retorna Dados (array)         â”‚
        â”‚   â† Model                       â”‚
        â”‚   â† Controller                  â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    RENDERIZAÃ‡ÃƒO DE VIEW         â”‚
        â”‚                                 â”‚
        â”‚  1. header.php (layout)         â”‚
        â”‚  2. clientes/listar.php (view)  â”‚
        â”‚  3. footer.php (layout)         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚      HTML GERADO                â”‚
        â”‚   <?php foreach ($clientes) ... â”‚
        â”‚                                 â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚    NAVEGADOR EXIBE PÃGINA       â”‚
        â”‚    (Renderiza CSS, JS, etc)     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ESTRUTURA MVC SIMPLIFICADA

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         REQUEST HTTP                        â”‚
â”‚                  (GET, POST, PUT, DELETE)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                            â”‚
        â–¼                            â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  SESSION &   â”‚        â”‚   CONTROLLER     â”‚
    â”‚ VALIDATION   â”‚        â”‚  (LÃ³gica)        â”‚
    â”‚              â”‚        â”‚                  â”‚
    â”‚  â€¢ Authen.   â”‚â”€â”€â”€â”€â”€â”€â”€â†’â”‚ â€¢ input()        â”‚
    â”‚  â€¢ CSRF      â”‚        â”‚ â€¢ validate()     â”‚
    â”‚  â€¢ Permiss.  â”‚        â”‚ â€¢ logic          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â€¢ call model()   â”‚
                            â”‚ â€¢ render view()  â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚    MODEL         â”‚
                            â”‚  (Dados)         â”‚
                            â”‚                  â”‚
                            â”‚ â€¢ create()       â”‚
                            â”‚ â€¢ read()         â”‚
                            â”‚ â€¢ update()       â”‚
                            â”‚ â€¢ delete()       â”‚
                            â”‚ â€¢ queries        â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚    DATABASE      â”‚
                            â”‚  (MySQL + PDO)   â”‚
                            â”‚                  â”‚
                            â”‚ â€¢ Connection     â”‚
                            â”‚ â€¢ Prepared       â”‚
                            â”‚ â€¢ Transactions   â”‚
                            â”‚ â€¢ Logging        â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                            â”‚   Database       â”‚
                            â”‚   Tables         â”‚
                            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ (Returned data)         â”‚
                        â–¼                         â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Controller â”‚          â”‚  Status  â”‚
                    â”‚  receives   â”‚          â”‚  e logs  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      VIEW        â”‚
                    â”‚ (ApresentaÃ§Ã£o)   â”‚
                    â”‚                  â”‚
                    â”‚ â€¢ header.php     â”‚
                    â”‚ â€¢ main.php       â”‚
                    â”‚ â€¢ footer.php     â”‚
                    â”‚ â€¢ CSS            â”‚
                    â”‚ â€¢ JavaScript     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   HTML + CSS     â”‚
                    â”‚   JavaScript     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    NAVEGADOR     â”‚
                    â”‚  (RenderizaÃ§Ã£o)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ARQUITETURA DE PASTAS

```
SISTEMALAZER/
â”‚
â”œâ”€â”€ public/                    â† ENTRADA (Servidor Web)
â”‚   â”œâ”€â”€ index.php              â† Router (toda requisiÃ§Ã£o)
â”‚   â”œâ”€â”€ .htaccess              â† Reescrita de URL
â”‚   â”œâ”€â”€ css/                   â† Estilos (pÃºblico)
â”‚   â”œâ”€â”€ js/                    â† Scripts (pÃºblico)
â”‚   â””â”€â”€ img/                   â† Imagens (pÃºblico)
â”‚
â”œâ”€â”€ app/                       â† LÃ“GICA (Privado)
â”‚   â”‚
â”‚   â”œâ”€â”€ config/                â† ConfiguraÃ§Ã£o
â”‚   â”‚   â”œâ”€â”€ config.php         â† Constantes globais
â”‚   â”‚   â””â”€â”€ Session.php        â† Gerenc. sessÃ£o
â”‚   â”‚
â”‚   â”œâ”€â”€ database/              â† BD
â”‚   â”‚   â””â”€â”€ Database.php       â† PDO Singleton
â”‚   â”‚
â”‚   â”œâ”€â”€ models/                â† DADOS
â”‚   â”‚   â”œâ”€â”€ BaseModel.php      â† CRUD genÃ©rico
â”‚   â”‚   â””â”€â”€ ...                â† Modelos especÃ­ficos
â”‚   â”‚
â”‚   â”œâ”€â”€ controllers/           â† LÃ“GICA
â”‚   â”‚   â”œâ”€â”€ BaseController.php â† Utilidades
â”‚   â”‚   â””â”€â”€ ...                â† Controllers especÃ­ficos
â”‚   â”‚
â”‚   â”œâ”€â”€ views/                 â† APRESENTAÃ‡ÃƒO
â”‚   â”‚   â”œâ”€â”€ layout/            â† Templates comuns
â”‚   â”‚   â”‚   â”œâ”€â”€ header.php
â”‚   â”‚   â”‚   â””â”€â”€ footer.php
â”‚   â”‚   â””â”€â”€ modulo/            â† Views de mÃ³dulo
â”‚   â”‚       â”œâ”€â”€ index.php
â”‚   â”‚       â”œâ”€â”€ criar.php
â”‚   â”‚       â””â”€â”€ editar.php
â”‚   â”‚
â”‚   â””â”€â”€ ...
â”‚
â”œâ”€â”€ logs/                      â† REGISTROS
â”‚   â”œâ”€â”€ php_errors.log
â”‚   â”œâ”€â”€ database.log
â”‚   â”œâ”€â”€ session.log
â”‚   â””â”€â”€ application.log
â”‚
â””â”€â”€ DocumentaÃ§Ã£o/
    â”œâ”€â”€ README.md
    â”œâ”€â”€ INSTALACAO.md
    â””â”€â”€ ...
```

---

## COMPONENTES PRINCIPAIS

### 1. CONFIG.php
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        CONFIGURAÃ‡ÃƒO GLOBAL           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ DB_HOST, DB_NAME, DB_USER        â”‚
â”‚  â€¢ DB_PASS, DB_CHARSET              â”‚
â”‚  â€¢ Paths (ROOT, APP, PUBLIC)         â”‚
â”‚  â€¢ Security headers                  â”‚
â”‚  â€¢ Session timeout                   â”‚
â”‚  â€¢ Timezone, Idioma                  â”‚
â”‚  â€¢ Constantes da aplicaÃ§Ã£o           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    (Usado por todos)
```

### 2. Database.php (Singleton)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      CONEXÃƒO COM BANCO (PDO)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ getInstance() - InstÃ¢ncia Ãºnica   â”‚
â”‚  â€¢ execute() - INSERT, UPDATE, DEL   â”‚
â”‚  â€¢ select() - SELECT mÃºltiplos       â”‚
â”‚  â€¢ selectOne() - SELECT Ãºnico        â”‚
â”‚  â€¢ beginTransaction()                â”‚
â”‚  â€¢ commit(), rollback()              â”‚
â”‚  â€¢ Logging automÃ¡tico                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    (Usado por Models)
```

### 3. Session.php
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    GERENCIAMENTO DE SESSÃƒO           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â€¢ start() - Inicia sessÃ£o           â”‚
â”‚  â€¢ login() - Registra login          â”‚
â”‚  â€¢ logout() - DestrÃ³i sessÃ£o         â”‚
â”‚  â€¢ isAuthenticated()                 â”‚
â”‚  â€¢ hasPermission()                   â”‚
â”‚  â€¢ getCsrfToken()                    â”‚
â”‚  â€¢ validateCsrfToken()               â”‚
â”‚  â€¢ Timeout validation                â”‚
â”‚  â€¢ ID regeneration                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
    (Usado por Controllers)
```

### 4. BaseModel.php
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    OPERAÃ‡Ã•ES DE DADOS (CRUD)         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€ CREATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ â€¢ create($data)           â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â”Œâ”€ READ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ â€¢ find($id)               â”‚       â”‚
â”‚  â”‚ â€¢ all($filters, $options) â”‚       â”‚
â”‚  â”‚ â€¢ first($filters)         â”‚       â”‚
â”‚  â”‚ â€¢ count()                 â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â”Œâ”€ UPDATE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ â€¢ update($id, $data)      â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â”Œâ”€ DELETE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ â€¢ delete($id)             â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â€¢ query() - Custom queries          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â†“ (Estendida por)
   [ClienteModel, MaterialModel, ...]
```

### 5. BaseController.php
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     LÃ“GICA E ORQUESTRAÃ‡ÃƒO            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€ VALIDAÃ‡ÃƒO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ â€¢ requireAuth()            â”‚       â”‚
â”‚  â”‚ â€¢ requirePermission()      â”‚       â”‚
â”‚  â”‚ â€¢ validateCSRF()           â”‚       â”‚
â”‚  â”‚ â€¢ input()                  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â”Œâ”€ RESPOSTA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ â€¢ render()                 â”‚       â”‚
â”‚  â”‚ â€¢ redirect()               â”‚       â”‚
â”‚  â”‚ â€¢ successResponse()        â”‚       â”‚
â”‚  â”‚ â€¢ errorResponse()          â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚  â”Œâ”€ LOGGING â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ â€¢ log()                    â”‚       â”‚
â”‚  â”‚ â€¢ formatMoney()            â”‚       â”‚
â”‚  â”‚ â€¢ formatDate()             â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â†“ (Estendida por)
  [ClienteController, MaterialController, ...]
```

---

## CICLO DE VIDA DE UMA VIEW

```
1. Controller renderiza view
                â”‚
                â–¼
2. Extrai variÃ¡veis ($data)
                â”‚
                â–¼
3. Carrega header.php
   (Menu, CSS, JS global)
                â”‚
                â–¼
4. Carrega view especÃ­fica
   (Ex: clientes/listar.php)
   com acesso a $data
                â”‚
                â–¼
5. Carrega footer.php
   (RodapÃ©, scripts)
                â”‚
                â–¼
6. HTML pronto Ã© retornado
```

---

## FLUXO DE SEGURANÃ‡A

```
REQUEST CHEGA
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VALIDAÃ‡Ã•ES      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. AutenticaÃ§Ã£o â”‚
â”‚    (Session)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€ NÃƒO AUTENTICADO â”€â”€â†’ Redireciona /login
         â”‚
         â”œâ”€ AUTENTICADO
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VALIDAÃ‡Ã•ES      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 2. PermissÃ£o    â”‚
â”‚    (Roles)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€ SEM PERMISSÃƒO â”€â”€â†’ Erro 403
         â”‚
         â”œâ”€ COM PERMISSÃƒO
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ VALIDAÃ‡Ã•ES      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3. CSRF Token   â”‚
â”‚    (POST/PUT)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€ TOKEN INVÃLIDO â”€â”€â†’ Erro 403
         â”‚
         â”œâ”€ TOKEN VÃLIDO
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PROCESSAMENTO   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1. Sanitizar    â”‚
â”‚    inputs       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Query (PDO)  â”‚
â”‚    com prepared â”‚
â”‚    statements   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Render view  â”‚
â”‚    (escapar     â”‚
â”‚    output)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    RESPOSTA OK
```

---

## ROTAS AUTOMÃTICAS

```
URL Pattern: /modulo/acao/parametro1/parametro2

Exemplos:

/dashboard              â†’ DashboardController->index()
/dashboard/teste        â†’ DashboardController->teste()

/clientes               â†’ ClienteController->index()
/clientes/listar       â†’ ClienteController->listar()
/clientes/criar        â†’ ClienteController->criar()
/clientes/salvar       â†’ ClienteController->salvar()
/clientes/editar/123   â†’ ClienteController->editar(123)
/clientes/deletar/123  â†’ ClienteController->deletar(123)

/login                 â†’ LoginController->index()
/login/processar       â†’ LoginController->processar()
/login/logout          â†’ LoginController->logout()

/materiais/criar/chapa â†’ MaterialController->criar('chapa')
/orcamentos/pdf/456    â†’ OrcamentoController->pdf(456)
```

---

## INTEGRAÃ‡ÃƒO DE COMPONENTES

```
index.php (Router)
    â”‚
    â”œâ”€â†’ config.php (Constantes)
    â”‚
    â”œâ”€â†’ Session.php (AutenticaÃ§Ã£o)
    â”‚
    â”œâ”€â†’ BaseController (LÃ³gica)
    â”‚       â”‚
    â”‚       â”œâ”€â†’ BaseModel (CRUD)
    â”‚       â”‚       â”‚
    â”‚       â”‚       â””â”€â†’ Database.php (PDO)
    â”‚       â”‚               â”‚
    â”‚       â”‚               â””â”€â†’ MySQL
    â”‚       â”‚
    â”‚       â””â”€â†’ Views (RenderizaÃ§Ã£o)
    â”‚               â”‚
    â”‚               â”œâ”€â†’ header.php
    â”‚               â”œâ”€â†’ main.php
    â”‚               â””â”€â†’ footer.php
    â”‚
    â””â”€â†’ CSS/JS (Frontend)
```

---

Esta Ã© a arquitetura completa da ETAPA 1!

Tudo bem estruturado, seguro e pronto para as prÃ³ximas etapas. ğŸš€
